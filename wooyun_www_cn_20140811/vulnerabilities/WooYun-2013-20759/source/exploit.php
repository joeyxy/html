<?php

function eccode($string, $operation = 'DECODE', $key = '@LFK24s224%@safS3s%1f%') {

	$result = '';
	if ($operation == 'ENCODE') {
		for ($i = 0; $i < strlen($string); $i++) {
			$char = substr($string, $i, 1);
			$keychar = substr($key, ($i % strlen($key)) - 1, 1);
			$char = chr(ord($char) + ord($keychar));
			$result.=$char;
		}
		$result = base64_encode($result);
		$result = str_replace(array('+', '/', '='), array('-', '_', ''), $result);
	} elseif ($operation == 'DECODE') {
		$data = str_replace(array('-', '_'), array('+', '/'), $string);
		$mod4 = strlen($data) % 4;
		if ($mod4) {
			$data .= substr('====', $mod4);
		}
		$string = base64_decode($data);
		for ($i = 0; $i < strlen($string); $i++) {
			$char = substr($string, $i, 1);
			$keychar = substr($key, ($i % strlen($key)) - 1, 1);
			$char = chr(ord($char) - ord($keychar));
			$result.=$char;
		}
	}
	return $result;
}

$encrypted='lJamnKA';

$name='admin';

for($key=99;$key<1000;$key++)
{
	echo '[+]Testing:'.$key.'||';
	if(eccode($name,'ENCODE',$key)==$encrypted)
	{
		echo '---==========Key found:'.$key.'==========---||';
		die('Success');
	}
}
die('Fail');
?>